(function(e){function t(t){for(var i,a,r=t[0],s=t[1],l=t[2],u=0,v=[];u<r.length;u++)a=r[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&v.push(o[a][0]),o[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);c&&c(t);while(v.length)v.shift()();return d.push.apply(d,l||[]),n()}function n(){for(var e,t=0;t<d.length;t++){for(var n=d[t],i=!0,r=1;r<n.length;r++){var s=n[r];0!==o[s]&&(i=!1)}i&&(d.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={app:0},d=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/test-task-advmusic-1/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var c=s;d.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"533d":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("7a23"),o={class:"container"},d=Object(i["e"])(" 123 123 123 "),a=["textContent"];function r(e,t,n,r,s,l){var c=Object(i["l"])("video-player"),u=Object(i["l"])("app-modal");return Object(i["h"])(),Object(i["c"])("div",o,[d,Object(i["f"])(u,{ref:"modal",fullscreen:"",hideCloseButton:!!e.adCloseTimerCount},{header:Object(i["n"])((function(){return[e.adCloseTimerCount&&15e3!==e.adCloseTimerCount?(Object(i["h"])(),Object(i["c"])("div",{key:0,class:"modal__timer",textContent:Object(i["m"])(l.adCloseTimerText)},null,8,a)):Object(i["b"])("",!0)]})),default:Object(i["n"])((function(){return[Object(i["f"])(c,{ref:"video-player",playsinline:"",vast:e.vast,onResume:l.removeModal,onClose:l.removeModal,onLoadAd:l.initAdTimer},null,8,["vast","onResume","onClose","onLoadAd"])]})),_:1},8,["hideCloseButton"])])}var s,l={class:"video__container"},c=["playsinline"],u={ref:"ad",class:"ad__container"},v={key:0,class:"video__loader"};function h(e,t,n,o,d,a){return Object(i["h"])(),Object(i["c"])("div",l,[Object(i["d"])("video",{ref:"video",class:"video__element",playsinline:n.playsinline,onPlay:t[0]||(t[0]=Object(i["o"])((function(){return a.loadAds&&a.loadAds.apply(a,arguments)}),["prevent"]))},null,40,c),Object(i["d"])("div",u,null,512),e.isAdsLoad?Object(i["b"])("",!0):(Object(i["h"])(),Object(i["c"])("div",v))])}var m={name:"VideoPlayer",props:{vast:String,playsinline:Boolean},data:function(){return{videoElement:null,adDisplayContainer:null,adsLoader:null,isAdsLoad:!1,isAdsManagerLoad:!1,isAdsPlaying:!1}},mounted:function(){var e=this;this.vast||this.$emit("close"),this.videoElement=this.$refs.video,this.initAds(),window.addEventListener("resize",(function(){if(s){var t=e.videoElement.clientWidth,n=e.videoElement.clientHeight;s.resize(t,n,google.ima.ViewMode.NORMAL)}}))},methods:{initAds:function(){var e=this,t=this.$refs.ad,n=new google.ima.AdDisplayContainer(t,this.videoElement),i=new google.ima.AdsLoader(n);this.adDisplayContainer=n;var o=google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,d=google.ima.AdErrorEvent.Type.AD_ERROR;i.addEventListener(o,this.onAdsManagerLoaded,!1),i.addEventListener(d,this.onAdError,!1),this.videoElement.addEventListener("ended",(function(){i.contentComplete,e.$emit("close")}));var a=new google.ima.AdsRequest;a.adTagUrl=this.vast,a.linearAdSlotWidth=this.videoElement.clientWidth,a.linearAdSlotHeight=this.videoElement.clientHeight,a.nonLinearAdSlotWidth=this.videoElement.clientWidth,a.nonLinearAdSlotHeight=this.videoElement.clientHeight/3,i.requestAds(a)},onAdsManagerLoaded:function(e){var t=this;this.isAdsManagerLoad=!0;var n=function(){t.isAdsPlaying=!1,t.$emit("resume"),t.videoElement.play()};try{s=e.getAdsManager(this.videoElement);var i=google.ima.AdErrorEvent.Type.AD_ERROR,o=google.ima.AdEvent.Type,d=o.CONTENT_RESUME_REQUESTED,a=o.LOADED,r=o.COMPLETE;s.addEventListener(i,this.onAdError),s.addEventListener(d,n),s.addEventListener(r,n),s.addEventListener(a,this.onAdLoaded)}catch(l){n()}},onAdLoaded:function(e){e.getAd().isLinear()||this.videoElement.play()},onAdError:function(e){this.isAdsManagerLoad=!0,this.isAdsPlaying=!1,this.$emit("resume"),s&&s.destroy()},loadAds:function(){var e=this;if(!this.isAdsManagerLoad)return setTimeout(this.loadAds,50);if(!this.isAdsLoad){this.isAdsLoad=!0,this.$emit("loadAd"),this.videoElement.load(),this.videoElement.pause(),this.adDisplayContainer.initialize();try{var t=this.videoElement.clientWidth,n=this.videoElement.clientHeight;s.init(t,n,google.ima.ViewMode.NORMAL),s.start(),this.videoElement.addEventListener("click",(function(){return e.$emit("resume")}))}catch(i){this.$emit("resume"),this.videoElement.play()}}}}},f=(n("90e5"),n("6b0d")),p=n.n(f);const b=p()(m,[["render",h],["__scopeId","data-v-6bd38913"]]);var A=b,g={class:"modal__header"},E={class:"modal__content"};function y(e,t,n,o,d,a){return Object(i["h"])(),Object(i["c"])("dialog",{ref:"modal",class:Object(i["g"])(["modal__container",{"modal__container-fullscreen":n.fullscreen}])},[Object(i["d"])("div",g,[Object(i["k"])(e.$slots,"header"),n.hideCloseButton?Object(i["b"])("",!0):(Object(i["h"])(),Object(i["c"])("div",{key:0,class:"modal__button-close",onClick:t[0]||(t[0]=function(){return a.close&&a.close.apply(a,arguments)})}))]),Object(i["d"])("div",E,[Object(i["k"])(e.$slots,"default")])],2)}var O={name:"AppModal",props:{fullscreen:Boolean,hideCloseButton:Boolean},data:function(){return{modal:null}},mounted:function(){this.modal=this.$refs.modal},methods:{open:function(){this.modal.showModal()},close:function(){this.modal.close()}}};n("d600");const j=p()(O,[["render",y]]);var L=j,_={components:{VideoPlayer:A,AppModal:L},data:function(){return{vast:"https://yandex.ru/ads/adfox/168627/getCode?p1=bdcfe&p2=ekza&pfc=zymd&pfb=dkvcj",adCloseTimerCount:15e3}},computed:{adCloseTimerText:function(){var e=Math.ceil(this.adCloseTimerCount/1e3);return"Закрыть рекламу через ".concat(e," сек")}},mounted:function(){document.addEventListener("click",this.initAd)},methods:{initAd:function(){var e=this.$refs.modal,t=this.$refs["video-player"];"open"in e&&e.open(),"loadAds"in t&&t.loadAds(),document.removeEventListener("click",this.initAd)},initAdTimer:function(){var e=this,t=setInterval((function(){e.adCloseTimerCount>0?e.adCloseTimerCount-=50:clearInterval(t)}),50)},removeModal:function(){var e=this.$refs.modal.$el;"remove"in e&&e.remove(),document.removeEventListener("click",this.initAd)}}};n("bc6c");const C=p()(_,[["render",r]]);var M=C;Object(i["a"])(M).mount("#app")},"740e":function(e,t,n){},"8f6f":function(e,t,n){},"90e5":function(e,t,n){"use strict";n("740e")},bc6c:function(e,t,n){"use strict";n("8f6f")},d600:function(e,t,n){"use strict";n("533d")}});
//# sourceMappingURL=app.7fc1f3ef.js.map